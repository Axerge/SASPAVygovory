/**
 * Массовое добавление правил SASPA в лист "Правила"
 * Запустите эту функцию один раз для импорта всех правил
 */
function importSASPARules() {
  try {
    const rulesData = [
      ['3.8. Халатно относиться к транспорту SASPA, бросать служебные автомобили, оставлять их возле парковок и штрафстоянок, равно как и использовать в личных целях.', 'Устный — VR (verbal reprimand)'],
      ['25.1. Использовать оружие не по назначению.', 'Устный — VR (verbal reprimand)'],
      ['25.2. Стоять без дела или спать на территории тюрьмы без соответствующего отчёта в специальной связи.', 'Устный — VR (verbal reprimand)'],
      ['25.3. Покидать тюрьму в рабочее время, за исключением случаев, оформленных в виде увольнительной или письменного приказа начальника исправительного учреждения либо его заместителей.\n\nПримечание: Старший состав имеет право покидать тюрьму без увольнительной.', 'Строгий — SR (severe reprimand)'],
      ['25.4. Покидать пост, патруль, тренировку или завершать работу без доклада по рации.', 'Устный — VR (verbal reprimand)'],
      ['25.5. Спать на посту, в строю или на тренировках.', 'Устный — VR (verbal reprimand)'],
      ['25.6. Нарушать установленный дресс-код своего отдела.', 'Устный — VR (verbal reprimand)'],
      ['25.7. Хранить, употреблять или распространять запрещённые наркотические или психотропные вещества.', 'Устный — VR (verbal reprimand) / Увольнение'],
      ['25.8. Использовать служебное имущество не по его прямому назначению.', 'Устный — VR (verbal reprimand)'],
      ['25.9. Намеренно нарушать приказы или игнорировать их, как в устной форме, так и в рации.', 'Письменный — WR (written reprimand)'],
      ['25.10. Игнорировать или выключать рацию во время рабочего дня. ((Brawl))', 'Устный — VR (verbal reprimand)'],
      ['25.11. Упрекать или перечить старшему составу.', 'Строгий — SR (severe reprimand)'],
      ['25.12. Выпрашивать повышение или проверку отчёта у старшего состава SASPA.', 'Устный — VR (verbal reprimand)'],
      ['25.13. Въезжать на личном транспорте на территорию тюрьмы без зафиксированной парковки.', 'Письменный — WR (written reprimand)'],
      ['25.14. Проводить посторонних лиц на территорию тюрьмы.\n\nПримечание: Исключением составляют сотрудники FIB, LSSD, LSPD, GOV, ARMY и EMS при соответствующем запросе руководства федеральной тюрьмы, а также посетители во время свидания с заключенными.', 'Письменный — WR (written reprimand) / Строгий — SR (severe reprimand)'],
      ['25.15. Нарушать положения о строе.', 'Устный — VR (verbal reprimand)'],
      ['25.16. Выполнять работу другого отдела без соответствующего распоряжения начальника тюрьмы или кураторов подразделений.', 'Устный — VR (verbal reprimand)'],
      ['25.17. Находиться на территории 2-го, 6-го блоков и внутреннего двора без сопровождения сотрудников FAS либо Старшего состава.\n\nИсключение: Сотрудники отдела OPA, MPS начиная с 6 ранга и сотрудники SDO начиная с 4 ранга, могут находится на территории внутреннего двора для выполнений задач отдела.', 'Устный — VR (verbal reprimand)'],
      ['25.18. Игнорировать отсутствие сотрудников на посту КПП. Ответственность за его дежурство является коллективной, и в случае пустого поста любой сотрудник обязан занять его или найти замену.', 'Письменный — WR (written reprimand)'],
      ['25.19. На КПП всегда должен находиться минимум один сотрудник, даже если для этого потребуется временное игнорирование своих прямых обязанностей.', 'Письменный — WR (written reprimand)'],
      ['25.20. Занимать чужие парковочные места на территории Федеральной Тюрьмы, что регулируется специализированным каналом.', 'Устный — VR (verbal reprimand)'],
      ['25.21. Использовать телефон на посту или в строю.', 'Устный — VR (verbal reprimand)'],
      ['25.22. Спать на посту более 10 минут или вне специальных помещений для отдыха.', 'Устный — VR (verbal reprimand)'],
      ['25.23. Пересекать КПП без остановки для проверки документов/досмотра авто.', 'Письменный — WR (written reprimand) / Строгий — SR (severe reprimand)'],
      ['25.24. Неестественное поведение ((эмоции, жесты, походки)) в служебное время.', 'Устный — VR (verbal reprimand)'],
      ['25.25. Нарушать правила парковки личного или служебного транспорта.', 'Письменный — WR (written reprimand)'],
      ['25.26. Увольнение из SASPA до достижения звания Постовой КПП без соблюдения процедуры увольнения.', 'Увольнение'],
      ['25.27. Использовать мегафон или другие средства оповещения не по назначению.', 'Письменный — WR (written reprimand) / Строгий — SR (severe reprimand)'],
      ['25.28. Нарушать правила использования служебной техники.', 'Письменный — WR (written reprimand) / Отстранение от работы'],
      ['25.29. Захламлять склад тюрьмы или багажники служебных автомобилей.', 'Письменный — WR (written reprimand) / Строгий — SR (severe reprimand)'],
      ['25.30. Иметь просроченную медицинскую карту.', 'Устный — VR (verbal reprimand) / Письменный — WR (written reprimand)'],
      ['25.31. Отказ в предоставлении сотруднику MPS медицинскую карту.', 'Письменный — WR (written reprimand) / Строгий — SR (severe reprimand)'],
      ['25.32. Пренебрежение запретам, как сотрудникам SASPA, так и сотрудникам отделов в целом.', 'Устный — VR (verbal reprimand) / Письменный — WR (written reprimand) / Строгий — SR (severe reprimand)'],
      ['25.33. Каждый сотрудник, назначенный на переаттестацию, обязан пройти её в течение трех дней.\n\nПримечание: По истечении трёх дней, в случае несдачи, сотруднику выдается выговор и предоставляется дополнительный срок в 24 часа для повторного прохождения переаттестации. Если сотрудник не сдаёт переаттестацию в указанный срок, он будет уволен в соответствии с Главой 7, Статьей 7.2 А ТК.', 'Строгий — SR (severe reprimand) / Увольнение'],
      ['25.34. Все сотрудники, включая тех, кто работает в академии, обязаны предоставить еженедельный отчет о проделанной работе, не позднее 19:00 воскресенья.', 'Строгий — SR (severe reprimand)'],
      ['25.35. Во время сборов на СО сотрудникам Федеральной Тюрьмы запрещено брать отпуск/перерыв.', 'Письменный — WR (written reprimand)']
    ];
    
    const ss = getOrCreateSpreadsheet();
    const rulesSheet = getOrCreateRulesSheet();
    
    // Проверяем, есть ли уже данные (кроме заголовка)
    const existingRows = rulesSheet.getLastRow();
    if (existingRows > 1) {
      Logger.log('⚠️ ВНИМАНИЕ: В листе "Правила" уже есть данные!');
      Logger.log('Текущее количество правил: ' + (existingRows - 1));
      Logger.log('Если хотите перезаписать, сначала очистите лист вручную или используйте функцию clearRulesSheet()');
      return {
        success: false,
        error: 'Лист "Правила" уже содержит данные. Используйте clearRulesSheet() для очистки перед импортом.'
      };
    }
    
    // Добавляем все правила одним запросом для скорости
    const startRow = rulesSheet.getLastRow() + 1;
    rulesSheet.getRange(startRow, 1, rulesData.length, 2).setValues(rulesData);
    
    Logger.log('✅ УСПЕШНО импортировано правил: ' + rulesData.length);
    Logger.log('Правила добавлены в лист "Правила"');
    
    // Форматируем для красоты
    rulesSheet.autoResizeColumn(1);
    rulesSheet.setColumnWidth(1, 600); // Устанавливаем фиксированную ширину для колонки "Правило"
    rulesSheet.setColumnWidth(2, 400); // Для колонки "Мера наказания"
    
    // Включаем перенос текста
    rulesSheet.getRange(2, 1, rulesData.length, 2).setWrap(true);
    
    logAction({
      action: 'IMPORT_RULES',
      userId: '',
      userName: 'Система',
      details: `Импортировано ${rulesData.length} правил SASPA`
    });
    
    return {
      success: true,
      message: `Успешно импортировано ${rulesData.length} правил`,
      count: rulesData.length
    };
  } catch (error) {
    Logger.log('❌ ОШИБКА импорта правил: ' + error.toString());
    return {
      success: false,
      error: error.toString()
    };
  }
}

/**
 * Очистка листа "Правила" (кроме заголовка)
 * ОСТОРОЖНО: Удалит все существующие правила!
 */
function clearRulesSheet() {
  try {
    const rulesSheet = getOrCreateRulesSheet();
    const lastRow = rulesSheet.getLastRow();
    
    if (lastRow > 1) {
      rulesSheet.deleteRows(2, lastRow - 1);
      Logger.log('✅ Лист "Правила" очищен. Удалено строк: ' + (lastRow - 1));
      
      logAction({
        action: 'CLEAR_RULES',
        userId: '',
        userName: 'Система',
        details: `Очищен лист правил (удалено ${lastRow - 1} записей)`
      });
      
      return { success: true, message: `Удалено ${lastRow - 1} правил` };
    } else {
      Logger.log('ℹ️ Лист "Правила" уже пуст');
      return { success: true, message: 'Лист уже пуст' };
    }
  } catch (error) {
    Logger.log('❌ ОШИБКА очистки: ' + error.toString());
    return { success: false, error: error.toString() };
  }
}

/**
 * Импорт с перезаписью (очистка + импорт)
 */
function reimportSASPARules() {
  const clearResult = clearRulesSheet();
  if (!clearResult.success) {
    return clearResult;
  }
  
  return importSASPARules();
}

